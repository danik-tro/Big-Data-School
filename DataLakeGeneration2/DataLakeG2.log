INFO - 06-Nov-20 15:27:42 - create_file_system has been started
INFO - 06-Nov-20 15:27:42 - Request URL: 'https://bds0tro.blob.core.windows.net/container03?restype=REDACTED&sv=REDACTED&ss=REDACTED&srt=REDACTED&sp=REDACTED&se=REDACTED&st=REDACTED&spr=REDACTED&sig=REDACTED'
INFO - 06-Nov-20 15:27:42 - Request method: 'PUT'
INFO - 06-Nov-20 15:27:42 - Request headers:
INFO - 06-Nov-20 15:27:42 -     'x-ms-version': 'REDACTED'
INFO - 06-Nov-20 15:27:42 -     'x-ms-date': 'REDACTED'
INFO - 06-Nov-20 15:27:42 -     'x-ms-client-request-id': 'd96a3590-2033-11eb-ac9e-04d4c47a1bd8'
INFO - 06-Nov-20 15:27:42 -     'User-Agent': 'azsdk-python-storage-dfs/12.1.2 Python/3.8.5 (Windows-10-10.0.17763-SP0)'
INFO - 06-Nov-20 15:27:42 - No body was attached to the request
INFO - 06-Nov-20 15:27:43 - Response status: 409
INFO - 06-Nov-20 15:27:43 - Response headers:
INFO - 06-Nov-20 15:27:43 -     'Content-Length': '230'
INFO - 06-Nov-20 15:27:43 -     'Content-Type': 'application/xml'
INFO - 06-Nov-20 15:27:43 -     'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
INFO - 06-Nov-20 15:27:43 -     'x-ms-request-id': 'bd77b0a7-801e-00a4-4d40-b4e940000000'
INFO - 06-Nov-20 15:27:43 -     'x-ms-client-request-id': 'd96a3590-2033-11eb-ac9e-04d4c47a1bd8'
INFO - 06-Nov-20 15:27:43 -     'x-ms-version': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-error-code': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'Date': 'Fri, 06 Nov 2020 13:27:41 GMT'
ERROR - 06-Nov-20 15:27:43 - Exception occurred in create_file_system
Traceback (most recent call last):
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\blob\_container_client.py", line 280, in create_container
    return self._client.container.create( # type: ignore
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\blob\_generated\operations\_container_operations.py", line 120, in create
    raise models.StorageErrorException(response, self._deserialize)
azure.storage.blob._generated.models._models_py3.StorageErrorException: Operation returned an invalid status 'The specified container already exists.'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/Daniil Trotsenko/Documents/Educate/Python/BDS/DataLakeGeneration2/data_lake_gen_2.py", line 41, in create_file_system
    self.file_system_client = self.dt_service.create_file_system(file_system=self.file_system_name)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_data_lake_service_client.py", line 246, in create_file_system
    file_system_client.create_file_system(metadata=metadata, public_access=public_access, **kwargs)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_file_system_client.py", line 241, in create_file_system
    return self._container_client.create_container(metadata=metadata,
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\core\tracing\decorator.py", line 83, in wrapper_use_tracer
    return func(*args, **kwargs)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\blob\_container_client.py", line 288, in create_container
    process_storage_error(error)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\blob\_shared\response_handlers.py", line 147, in process_storage_error
    raise error
azure.core.exceptions.ResourceExistsError: The specified container already exists.
RequestId:bd77b0a7-801e-00a4-4d40-b4e940000000
Time:2020-11-06T13:27:42.4009313Z
ErrorCode:ContainerAlreadyExists
Error:None
INFO - 06-Nov-20 15:27:43 - create_file_system has been finished
INFO - 06-Nov-20 15:27:43 - create_directory has been started
INFO - 06-Nov-20 15:27:43 - Request URL: 'https://bds0tro.blob.core.windows.net/container03/folder01?resource=REDACTED&sv=REDACTED&ss=REDACTED&srt=REDACTED&sp=REDACTED&se=REDACTED&st=REDACTED&spr=REDACTED&sig=REDACTED'
INFO - 06-Nov-20 15:27:43 - Request method: 'PUT'
INFO - 06-Nov-20 15:27:43 - Request headers:
INFO - 06-Nov-20 15:27:43 -     'x-ms-properties': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-version': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-date': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-client-request-id': 'd990443c-2033-11eb-8b88-04d4c47a1bd8'
INFO - 06-Nov-20 15:27:43 -     'User-Agent': 'azsdk-python-storage-dfs/12.1.2 Python/3.8.5 (Windows-10-10.0.17763-SP0)'
INFO - 06-Nov-20 15:27:43 - No body was attached to the request
INFO - 06-Nov-20 15:27:43 - Response status: 400
INFO - 06-Nov-20 15:27:43 - Response headers:
INFO - 06-Nov-20 15:27:43 -     'Content-Length': '301'
INFO - 06-Nov-20 15:27:43 -     'Content-Type': 'application/xml'
INFO - 06-Nov-20 15:27:43 -     'Server': 'Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0'
INFO - 06-Nov-20 15:27:43 -     'x-ms-error-code': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-request-id': 'bd77b0cc-801e-00a4-6d40-b4e940000000'
INFO - 06-Nov-20 15:27:43 -     'x-ms-version': 'REDACTED'
INFO - 06-Nov-20 15:27:43 -     'x-ms-client-request-id': 'd990443c-2033-11eb-8b88-04d4c47a1bd8'
INFO - 06-Nov-20 15:27:43 -     'Date': 'Fri, 06 Nov 2020 13:27:42 GMT'
ERROR - 06-Nov-20 15:27:43 - Exception occurred in create_directory
Traceback (most recent call last):
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_path_client.py", line 193, in _create
    return self._client.path.create(**options)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_generated\operations\_path_operations.py", line 251, in create
    raise models.StorageErrorException(response, self._deserialize)
azure.storage.filedatalake._generated.models._models_py3.StorageErrorException: Operation returned an invalid status 'An HTTP header that's mandatory for this request is not specified.'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/Daniil Trotsenko/Documents/Educate/Python/BDS/DataLakeGeneration2/data_lake_gen_2.py", line 50, in create_directory
    self.dict_of_directory[name_directory] = self.file_system_client.create_directory(name_directory)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_file_system_client.py", line 536, in create_directory
    directory_client.create_directory(metadata=metadata, **kwargs)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_data_lake_directory_client.py", line 157, in create_directory
    return self._create('directory', metadata=metadata, **kwargs)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_path_client.py", line 195, in _create
    process_storage_error(error)
  File "C:\Users\Daniil Trotsenko\anaconda3\envs\BDS\lib\site-packages\azure\storage\filedatalake\_deserialize.py", line 55, in process_storage_error
    additional_data[info] = error_body[info]
TypeError: element indices must be integers
INFO - 06-Nov-20 15:27:43 - create_directory has been finished
INFO - 06-Nov-20 15:27:43 - create_subdirectory has been started
ERROR - 06-Nov-20 15:27:43 - Exception occurred in create_subdirectory
Traceback (most recent call last):
  File "C:/Users/Daniil Trotsenko/Documents/Educate/Python/BDS/DataLakeGeneration2/data_lake_gen_2.py", line 58, in create_subdirectory
    self.dict_of_directory[name_subdirectory] = self.dict_of_directory[name_directory].\
KeyError: 'folder01'
INFO - 06-Nov-20 15:27:43 - create_subdirectory has been finished
INFO - 06-Nov-20 15:27:43 - create_subdirectory has been started
ERROR - 06-Nov-20 15:27:43 - Exception occurred in create_subdirectory
Traceback (most recent call last):
  File "C:/Users/Daniil Trotsenko/Documents/Educate/Python/BDS/DataLakeGeneration2/data_lake_gen_2.py", line 58, in create_subdirectory
    self.dict_of_directory[name_subdirectory] = self.dict_of_directory[name_directory].\
KeyError: 'folder02'
INFO - 06-Nov-20 15:27:43 - create_subdirectory has been finished
